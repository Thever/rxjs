<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>rxjs</title>
</head>
<body>
    <h1>在集合console.log来查看代码的演示效果</h1>
</body>
<script src="https://cdn.bootcdn.net/ajax/libs/rxjs/6.2.0/rxjs.umd.min.js"></script>
<script>
    //  cdn引用的直接调用
    // rxjs.interval(500).pipe(rxjs.operators.take(4)).subscribe(console.log)

    const {fromEventPattern} = rxjs
    function addClick(handle){
        document.addEventListener('click',handle)
    }
    function removeClick(handle){
        document.removeEventListener('click',handle)
    }
    //  formEventPattern合并事件
    fromEventPattern(
        addClick,
        removeClick
    ).subscribe(x=>console.log(x))

    // const { fromEventPattern } = rxjs

    // class EventEmitter {
    //     constructor () {
    //         this.handlers = {}
    //     }
    //     on (eventName, handler) {
    //         if (!this.handlers[eventName]) {
    //         this.handlers[eventName] = []
    //         }
    //         if(typeof handler === 'function') {
    //             this.handlers[eventName].push(handler)
    //         } else {
    //             throw new Error('handler 不是函数！！！')
    //         }
    //     }
    //     off (eventName, handler) {
    //         this.handlers[eventName].splice(this.handlers[eventName].indexOf(handler), 1)
    //     }
    //     emit (eventName, ...args) {
    //         this.handlers[eventName].forEach(handler => {
    //         handler(...args)
    //         })
    //     }
    // }

    // const event = new EventEmitter()

    // const subscription = fromEventPattern(
    //     event.on.bind(event, 'say'), 
    //     event.off.bind(event, 'say')
    // ).subscribe(x => console.log(x))

    // let timer = (() => {
    // let number = 1
    // return setInterval(() => {
    //     if (number === 5) {
    //     clearInterval(timer)
    //     timer = null
    //     }
    //     event.emit('say', number++)
    // }, 1000)
    // })()

    // setTimeout(() => {
    // subscription.unsubscribe()
    // }, 3000)

</script>
</html>